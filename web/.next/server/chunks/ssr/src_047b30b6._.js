module.exports=[19776,a=>{"use strict";var b=a.i(11481);(0,b.registerVersion)("firebase","12.7.0","app");var c=b;a.i(35027);var c=b;a.i(16575);var d=a.i(97863);let e=(0,c.getApps)().length?(0,c.getApp)():(0,c.initializeApp)({apiKey:"AIzaSyAEEETL2OND89Wp3jz0MTNBdNzaVfvQfGg",authDomain:"zeroechodaily-fa928.firebaseapp.com",projectId:"zeroechodaily-fa928",storageBucket:"zeroechodaily-fa928.firebasestorage.app",messagingSenderId:"48848484312",appId:"1:48848484312:web:40ff615aabb494accca4ad"}),f=(0,d.getFirestore)(e);class g{static detectVersion(a){return a.schema_version?a.schema_version:"edition_code"in a&&a.edition_code?"3.0":"unknown"}static parseMetaIssues(a){return a.map(a=>this.parseMetaIssue(a))}static parseMetaIssue(a){let b=a.schema_version||"unknown",c=["3.1","3.0"],d=c.find(a=>b===a);if(!d&&"unknown"!==b){let[a,e]=b.split(".").map(Number);(d=c.find(b=>{let[c]=b.split(".").map(Number);return c===a}))&&console.info(`[SchemaParser] v${b} â†’ v${d} fallback`)}return d?.startsWith("3.")?this._parseV3Issue(a,b):(console.warn(`[SchemaParser] Unsupported schema version: ${b}`),this._emptyIssue(b))}static _parseV3Issue(a,b){let c=a.edition_code||"",d=a.edition_name||"",e=a.article_count??0,f=a.published_at||"",g=a.updated_at||"",h=a.status||"preview",i=this.parseEditionCodeToDate(c);return{id:c,edition_code:c,edition_name:d,article_count:e,published_at:f,updated_at:g,status:h,date:i,schema_version:b}}static _emptyIssue(a){return{id:"",edition_code:"",edition_name:"",article_count:0,published_at:"",updated_at:"",status:"preview",date:"",schema_version:a}}static parsePublicationDoc(a){let b=this.detectVersion(a),c=a.edition_code||"",d=a.edition_name||"",e=a.article_count||a.articles?.length||0,f=a.published_at||"",g=a.updated_at||"",h=a.released_at,i=a.status||"preview",j=a.date||this.parseEditionCodeToDate(c);return{id:c,edition_code:c,edition_name:d,article_count:e,published_at:f,updated_at:g,released_at:h,status:i,date:j,schema_version:b}}static parseArticles(a){return a.map(a=>this.parseArticle(a))}static parseArticle(a){let b=a.id||a.article_id||"";return{id:b,article_id:b,title:a.title||a.title_ko||"",title_ko:a.title_ko||a.title||"",title_en:a.title_en||"",summary:a.summary||"",url:a.url||"",source_id:a.source_id||"unknown",category:a.category||"Uncategorized",layout_type:a.layout_type||"Standard",impact_score:a.impact_score??0,zero_echo_score:a.zero_echo_score??0,tags:a.tags||[],published_at:a.published_at||"",date:a.date||"",filename:a.filename||`${a.source_id}_${b}.json`}}static parseEditionCodeToDate(a){if(!a)return"";let b=a.replace(/_\d+$/,"");if(b&&6===b.length&&/^\d{6}$/.test(b)){let a=b.substring(0,2),c=b.substring(2,4),d=b.substring(4,6);return`20${a}-${c}-${d}`}return""}static debugInfo(a){let b=this.detectVersion(a),c=Object.keys(a).join(", ");return`[SchemaParser] Version: ${b}, Fields: ${c}`}}let h="release";function i(a){return(0,d.collection)(f,h,"data",a)}function j(a,b){return(0,d.doc)(f,h,"data",a,b)}let k="publications";async function l(a=!1){try{console.log(`ðŸ“– [Firestore] Fetching _meta document... (includePreview: ${a})`);let b=await (0,d.getDoc)(j(k,"_meta"));if(!b.exists())return console.log("âš ï¸ [Firestore] _meta document not found, falling back to full scan..."),await m();let c=b.data(),e=c.latest_updated_at||null,f=(c.issues||[]).filter(b=>"released"===b.status||a&&"preview"===b.status),h=g.parseMetaIssues(f).map(a=>({id:a.id,edition_code:a.edition_code,edition_name:a.edition_name,article_count:a.article_count,published_at:a.published_at,updated_at:a.updated_at,released_at:a.released_at,status:a.status,date:a.date}));return h.sort((a,b)=>b.edition_code.localeCompare(a.edition_code)),console.log(`âœ… [Firestore] Found ${h.length} released issues from _meta (Schema versions detected)`),{issues:h,latestUpdatedAt:e}}catch(a){return console.error("âŒ [Firestore] Failed to fetch _meta:",a),await m()}}async function m(){try{console.log("ðŸ“– [Firestore] Fallback: scanning all publications...");let a=await (0,d.getDocs)(i(k)),b=[],c=null;a.forEach(a=>{if(a.id.startsWith("_"))return;let c=a.data();b.push({id:a.id,...c})});let e=b.filter(a=>"released"===a.status);for(let a of(e.sort((a,b)=>b.edition_code.localeCompare(a.edition_code)),e))a.updated_at&&(!c||new Date(a.updated_at)>new Date(c))&&(c=a.updated_at);return console.log(`âœ… [Firestore] Fallback found ${e.length} released issues`),{issues:e,latestUpdatedAt:c}}catch(a){return console.error("âŒ [Firestore] Fallback failed:",a),{issues:[],latestUpdatedAt:null}}}async function n(a){try{let b=await (0,d.getDoc)(j(k,a));if(!b.exists())return console.log(`âš ï¸ [Firestore] Publication not found: ${a}`),[];let c=b.data().articles||[];return g.parseArticles(c).map(a=>({id:a.id,article_id:a.article_id,title:a.title,title_ko:a.title_ko,title_en:a.title_en,summary:a.summary,url:a.url,source_id:a.source_id,category:a.category,layout_type:a.layout_type,impact_score:a.impact_score,zero_echo_score:a.zero_echo_score,tags:a.tags,published_at:a.published_at,date:a.date,filename:a.filename}))}catch(b){return console.error(`âŒ [Firestore] Failed to fetch articles for ${a}:`,b),[]}}async function o(){try{let a=await (0,d.getDoc)(j(k,"_meta"));if(a.exists())return a.data().latest_updated_at||null;console.log("âš ï¸ [Firestore] _meta not found, falling back...");let{latestUpdatedAt:b}=await m();return b}catch(a){return console.error("âŒ [Firestore] checkLatestUpdate failed:",a),null}}async function p(b=20){try{console.log(`ðŸ“– [Firestore] Fetching trend reports... (limit: ${b})`);let{query:c,orderBy:e,limit:f}=await a.A(37108),g=i("trend_reports"),h=c(g,e("created_at","desc"),f(b)),j=await (0,d.getDocs)(h),k=[];return j.forEach(a=>{let b=a.data();k.push({id:a.id,period:b.period||{},created_at:b.created_at||"",top_trends:b.top_trends||[],tag_rankings:b.tag_rankings||[],weekly_insight:b.weekly_insight||"",next_week_outlook:b.next_week_outlook||""})}),console.log(`âœ… [Firestore] Found ${k.length} trend reports`),k}catch(a){return console.error("âŒ [Firestore] Failed to fetch trend reports:",a),[]}}a.s(["checkLatestUpdate",()=>o,"fetchArticlesByIssueId",()=>n,"fetchPublishedIssues",()=>l,"fetchTrendReports",()=>p],19776)},83791,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/HomePageClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/HomePageClient.tsx <module evaluation>","default")},61643,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/HomePageClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/HomePageClient.tsx","default")},73689,a=>{"use strict";a.i(83791);var b=a.i(61643);a.n(b)},24093,a=>{"use strict";let b={grid:{totalColumns:10,cellHeight:10,gap:4},volumeFactors:{scoreWeight:3,textWeight:0},constraints:{minWidth:3,maxWidth:8,minHeight:2},shapeEfficiency:{narrowThreshold:3,narrowFactor:.9,wideThreshold:6,wideFactor:1.1,standardFactor:1},physics:{colWidthPx:116,lineHeightPx:24,charWidthPx:13,paddingPx:40,headerHeightPx:130},corrections:{lineClamp:[{minRatio:2,minRows:0,lines:8},{minRatio:1.4,minRows:3,lines:6},{minRatio:1,minRows:0,lines:5},{minRatio:0,minRows:4,lines:5},{minRatio:0,minRows:0,lines:3}]}};class c{gridCols;gridRows;grid;placements;nextRow;constructor(a=10,b=100){this.gridCols=a,this.gridRows=b,this.grid=this.createEmptyGrid(a,b),this.placements=[],this.nextRow=0}createEmptyGrid(a,b){return Array.from({length:b},()=>Array.from({length:a},()=>({occupied:!1})))}expandGridIfNeeded(a){for(;this.gridRows<a;)this.grid.push(Array.from({length:this.gridCols},()=>({occupied:!1}))),this.gridRows++}findPosition(a,b,c=0){for(let d=c;d<this.gridRows;d++){for(let c=0;c<=this.gridCols-a;c++)if(this.canPlace(c,d,a,b))return{col:c,row:d};d>=this.gridRows-b-1&&this.expandGridIfNeeded(this.gridRows+10)}let d=Math.max(this.gridRows,c);return this.expandGridIfNeeded(d+b),{col:0,row:d}}canPlace(a,b,c,d){this.expandGridIfNeeded(b+d);for(let e=b;e<b+d;e++)for(let b=a;b<a+c;b++)if(b>=this.gridCols||this.grid[e][b].occupied)return!1;return!0}markOccupied(a,b,c,d,e){this.expandGridIfNeeded(b+d);for(let f=b;f<b+d;f++)for(let b=a;b<a+c;b++)this.grid[f][b]={occupied:!0,articleId:e};this.nextRow=Math.max(this.nextRow,b+d)}placeArticle(a,b=0){let c=this.findPosition(a.cols,a.rows,b);if(!c)return null;this.markOccupied(c.col,c.row,a.cols,a.rows,a.id);let d={article:a,...c};return this.placements.push(d),d}detectGaps(a=6){let b=[],c=new Set;for(let d=0;d<this.nextRow;d++)for(let e=0;e<this.gridCols;e++){let f=`${e},${d}`;if(c.has(f)||this.grid[d][e].occupied)continue;let g=this.findLargestGap(e,d,c);g&&g.area>=a&&b.push(g)}return b.sort((a,b)=>b.area-a.area)}findLargestGap(a,b,c){let d=0;for(let c=a;c<this.gridCols&&!this.grid[b][c].occupied;c++)d++;let e=0,f=d;for(let c=b;c<this.nextRow;c++){let b=0;for(let d=a;d<a+f&&!this.grid[c][d].occupied;d++)b++;if(0===b)break;f=Math.min(f,b),e++}for(let d=b;d<b+e;d++)for(let b=a;b<a+f;b++)c.add(`${b},${d}`);return{col:a,row:b,width:f,height:e,area:f*e}}findFillerForGap(a,b){let c=b.filter(b=>b.cols<=a.width&&b.rows<=a.height);return 0===c.length?null:(c.sort((b,c)=>{let d=b.zeroEchoScore-c.zeroEchoScore;if(Math.abs(d)>.5)return d;let e=b.cols*b.rows/a.area;return c.cols*c.rows/a.area-e}),c[0]||null)}optimizeLayout(a){this.gridRows=100,this.grid=this.createEmptyGrid(this.gridCols,this.gridRows),this.placements=[],this.nextRow=0;let c=a.map((a,c)=>({...a,id:a.id||a.url||`article-${c}`,...(a=>{let{constraints:c,physics:d,grid:e}=b,f=(a.summary||"").length,g=a.impact_score||0,h=c.minWidth,i=c.maxWidth,j=h+(a=>{if(!a)return 0;let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)})(a.id||"")%(i-h+1);g>=7&&(j=Math.max(j,6));let k=Math.ceil(f/(((j=Math.min(j,i))*d.colWidthPx-d.paddingPx-(j-1)*e.gap)/d.charWidthPx)),l=Math.ceil((d.headerHeightPx+k*d.lineHeightPx+d.paddingPx+16)/(e.cellHeight+16));return l+=2,{cols:j,rows:l=Math.min(l=Math.max(l,5),80)}})(a),zeroEchoScore:a.zero_echo_score||0,impactScore:a.impact_score||0})),d=[...c].sort((a,b)=>{let c=10-a.zeroEchoScore+a.impactScore;return 10-b.zeroEchoScore+b.impactScore-c}),e=new Set,f=[],g=[...c].sort((a,b)=>{let c=10-a.zeroEchoScore+a.impactScore;return 10-b.zeroEchoScore+b.impactScore-c}),h=[...c].sort((a,b)=>{let c=a.zeroEchoScore-b.zeroEchoScore;return .01>Math.abs(c)?b.impactScore-a.impactScore:c}),i=[...c].sort((a,b)=>b.impactScore-a.impactScore),j=new Map,k=(a,b)=>{j.has(a)||j.set(a,[]),j.get(a).push(b)};g.length>0&&k(g[0].id,"Today's Headline"),h.length>0&&k(h[0].id,"Zero Echo Award"),i.length>0&&k(i[0].id,"Hot Topic");let l=[],m=new Set,n=g.length>0?g[0].id:null,o=h.length>0?h[0].id:null,p=i.length>0?i[0].id:null;n&&!m.has(n)&&(l.push(n),m.add(n)),o&&!m.has(o)&&(l.push(o),m.add(o)),p&&!m.has(p)&&(l.push(p),m.add(p));let q=n?c.find(a=>a.id===n):null,r=o?c.find(a=>a.id===o):null,s=p?c.find(a=>a.id===p):null;console.log(`[Awards] Today's Headline: ${q?.id?.substring(0,30)}`),console.log(`[Awards] Zero Echo Award: ${r?.id?.substring(0,30)}`),console.log(`[Awards] Hot Topic: ${s?.id?.substring(0,30)}`);let t=0;for(let a=0;a<l.length;a++){let b=c.find(b=>b.id===l[a]);if(!b)continue;b.awards=j.get(b.id)||[],0===a&&(b.cols=10);let d=this.placeArticle(b,t);d&&(e.add(b.id),f.push(b),t=0===a?d.row+d.article.rows:d.row)}console.log(`[Phase 0] After Top 3: finalOrder=${f.length}, placed=${e.size}`),d.length;for(let a=0;a<d.length;a++){let b=d[a];!e.has(b.id)&&this.placeArticle(b)&&(e.add(b.id),f.push(b))}let u=d.filter(a=>!e.has(a.id));for(let a=0;a<3;a++)for(let a of this.detectGaps(6)){let b=u.filter(a=>!e.has(a.id)),c=this.findFillerForGap(a,b);c&&this.canPlace(a.col,a.row,c.cols,c.rows)&&(this.markOccupied(a.col,a.row,c.cols,c.rows,c.id),e.add(c.id),f.push(c))}for(let a of u)e.has(a.id)||(this.placeArticle(a),e.add(a.id),f.push(a));return console.log(`[LayoutOptimizer] Input: ${a.length}, Output: ${f.length}`),f}getGridStats(){let a=0,b=this.nextRow*this.gridCols;for(let b=0;b<this.nextRow;b++)for(let c=0;c<this.gridCols;c++)this.grid[b][c].occupied&&a++;return{occupiedCells:a,totalCells:b,fillRate:b>0?a/b:0}}}a.s(["optimizeArticleOrder",0,a=>new c(10).optimizeLayout(a)],24093)}];

//# sourceMappingURL=src_047b30b6._.js.map